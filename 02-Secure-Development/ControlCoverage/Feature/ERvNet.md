## IMPORTANT: DevOps Kit (AzSK) is being sunset by end of FY21. More details [here](../../../ReleaseNotes/AzSKSunsetNotice.md)
----------------------------------------------

<html>
<head>

</head><body>
<H2>ERvNet</H2><table><tr><th>Description & Rationale</th><th>ControlSeverity</th><th>Automated</th><th>Fix Script</th></tr><tr><td><b>There must not be any Public IPs (i.e., NICs with PublicIP) on ExpressRoute-connected VMs</b><br/>Public IP addresses on an ER-connected virtual network can expose the corporate network to security attacks from the internet.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>There must not be multiple NICs on ExpressRoute-connected VMs</b><br/>Using multiple NICs, one can route traffic between the ER-connected virtual network and another non-ER-connected virtual network. This can put the corporate network at risk. (Multi-NIC VMs on an ER-connected virtual network may be required in some advanced scenarios. You should engage the network security team for a review in such cases.)</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>The 'EnableIPForwarding' flag must not be set to true for NICs in the ExpressRoute-connected vNet</b><br/>Using IP Forwarding one can change the routing of packets from an ER-connected virtual network. This can lead to bypass of network protections that are required and applicable for corpnet traffic. (IP Forwarding on an ER-connected virtual network may be required only in advanced scenarios such as Network Virtual Applicances. You should engage the network security team for a review in such cases.)</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>There must not be any NSGs on the GatewaySubnet of the ExpressRoute-connected vNet</b><br/>Using NSGs on the Gateway subnet of an ER-connected virtual network can cause the connection to stop functioning and may impact availability.</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>There must not be a UDR on *any* subnet in an ExpressRoute-connected vNet</b><br/>Using UDRs on any subnet of an ER-connected virtual network can lead to security exposure for corpnet traffic by allowing it to be routed in a way that evades inspection from network security scanners.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>There must not be another virtual network gateway (GatewayType = Vpn) in an ExpressRoute-connected vNet</b><br/>Using other gateway types on an ER-connected virtual network can lead to pathways for corpnet traffic where the traffic can get exposed to the internet or evade inspection from network security scanners. This creates a direct risk to corpnet security.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>There must not be any virtual network peerings on an ExpressRoute-connected vNet</b><br/>A virtual network peering on an ER-connected circuit establishes a link to another virtual network whereby traffic egress and ingress can evade inspection from network security appliances. This creates a direct risk to corpnet security.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Only internal load balancers (ILBs) may be used inside an ExpressRoute-connected vNet</b><br/>External load balancers on an ER-connected vNet can expose the corporate network to security attacks from the internet.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Only resources of type Microsoft.Network/* must be added in the ERNetwork resource group</b><br/>The ERNetwork resource group is a critical component that facilitates provisioning of an ER-connection for your subscription. This resource group is deployed and managed by the networking team and should not be used as a general purpose resource group or as a container for non-networking resources as it can impact the ER-connectivity of your subscription.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Ensure that the ERNetwork resource group is protected with a resource lock</b><br/>The ERNetwork resource group is a critical component that facilitates provisioning of an ER-connection for your subscription. A resource lock is deployed on the ERNetwork resource group to keep you from deleting it accidentally. Removing this lock increases the chances of accidental write/delete of this resource group and that can impact ER-connectivity of your subscription.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Ensure that ARM policies are deployed to protect the ERNetwork setup</b></td><td>High</td><td>Yes</td><td>No</td></tr></table>
<table>
</table>
</body></html>
