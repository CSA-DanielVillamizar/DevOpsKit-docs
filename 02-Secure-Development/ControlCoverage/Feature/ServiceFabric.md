<html>
<head>

</head><body>
<H2>ServiceFabric</H2><table><tr><th>Description & Rationale</th><th>ControlSeverity</th><th>Automated</th><th>Fix Script</th></tr><tr><td><b>Publicly exposed microservice endpoints must have authentication and authorization enforced</b><br/>If authentication and authorization are not correctly implemented, microservice endpoints may be easily accessed by anyone on the internet leading to compromise of sensitive data.</td><td>High</td><td>No</td><td>No</td></tr><tr><td><b>Publicly exposed endpoints must be secured using SSL</b><br/>Use of SSL ensures server/service authentication and protects data in transit from network layer man-in-the-middle, eavesdropping, session-hijacking attacks.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Application secrets must be encrypted with a certificate</b><br/>Protecting the connection string, storage account keys, password, etc., (stored in Settings.xml file in ConfigPackage of microservice, ServiceManifest.xml and ApplicationManifest.xml) ensures that these secrets do not get compromised through copies of the settings/manifest files that might be left unprotected on various systems.</td><td>High</td><td>No</td><td>No</td></tr><tr><td><b>Data replication must be secured with certificate</b><br/>The replication traffic of microservices must be protected using a certificate so that microservices are not be able to see each others' replication traffic.</td><td>Medium</td><td>No</td><td>No</td></tr><tr><td><b>Sensitive data must not be stored inside DataPackage</b><br/>DataPackage files can be accessed from other microservices running on same node (VM). DataPackage files get distributed along with the application package while publishing/deployment. This can lead to compromise of any sensitive data as copies of these deployment packages are often left unprotected.</td><td>High</td><td>No</td><td>No</td></tr><tr><td><b>Replica set size for stateful services must be set to a minimum of 3</b><br/>A replica set size of 3 or more in the case of stateful services ensures that data is not lost in the event of a single node failure.</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>Instance count for stateless service must be set to a minimum of 3</b><br/>An instance count of 3 or more guarantees high availability for stateless services in the event of a single node failure.</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>Service Fabric cluster security must be enabled using security mode option</b><br/>A secure cluster prevents unauthorized access to management operations, which includes deployment, upgrade, and deletion of microservices. Also provides encryption for node-to-node communication, client-to-node communication etc. In oppose to unsecure cluster which can be connected by any anonymous user.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Service Fabric cluster must contain only microservices which trust each other</b><br/>Microservice hosted on same Service Fabric cluster can monitor traffic of other microservices and access the files hosted on cluster. Hence the same Service Fabric cluster must not host microservices which do not trust each other.</td><td>High</td><td>No</td><td>No</td></tr><tr><td><b>Self-signed certs must not be used for Service Fabric cluster primary certificate</b><br/>The primary certificate of Service Fabric must be obtained from a trusted certification authority. This ensures that client applications/endpoints can validate the identities of microservices in the cluster in a secure manner.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Client authentication must be performed only via Azure Active Directory</b><br/>Using the native enterprise directory for authentication ensures that there is a built-in high level of assurance in the user identity established for subsequent access control. All Enterprise subscriptions are automatically associated with their enterprise directory (xxx.onmicrosoft.com) and users in the native directory are trusted for authentication to enterprise subscriptions.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>The ClusterProtectionLevel property must be set to EncryptAndSign</b><br/>With cluster protection level set to 'EncryptAndSign', all the node-to-node messages are encrypted and digitally signed. This protects the intra-cluster communication from eavesdropping/tampering/man-in-the-middle attacks on the network.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Network security group (NSG) must be enabled on subnets of Service Fabric cluster</b><br/>Use of appropriate NSG rules can limit exposure of Service Fabric cluster in multiple scenarios. For example, RDP connections can be restricted only for specific admin machines. Incoming requests to microservices may be restricted to specific clients. Also, deployments can be restricted to happen only from an allowed range of IP addresses.</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>Encryption must be enabled on all storage accounts which store VHDs of Service Fabric cluster VMs</b><br/>Using this feature ensures that sensitive data is stored encrypted at rest. This minimizes the risk of data loss from physical theft and also helps meet regulatory compliance requirements.</td><td>High</td><td>Yes</td><td>No</td></tr><tr><td><b>Diagnostics must be enabled for Service Fabric cluster</b><br/>Diagnostics logs are needed for creating activity trail while investigating an incident or a compromise.</td><td>Medium</td><td>Yes</td><td>No</td></tr><tr><td><b>Monitor publicly exposed ports on load balancers used by Service Fabric cluster</b><br/>Publically exposed ports must be monitored to detect suspicious and malicious activities early and respond in a timely manner.</td><td>Medium</td><td>No</td><td>No</td></tr><tr><td><b>Reverse proxy service should be secured using SSL</b><br/>Use of SSL ensures server/service authentication and protects data in transit from network layer man-in-the-middle, eavesdropping, session-hijacking attacks.</td><td>Medium</td><td> No</td><td>No</td></tr><tr><td><b>Reverse proxy port must not be exposed publicly</b><br/>Configuring the reverse proxy's port in Load Balancer with public IP will expose all microservices with HTTP endpoint. Microservices meant to be internal may be discoverable by a determined malicious user.</td><td> High</td><td>Yes</td><td> No</td></tr><tr><td><b>Upgrade mode should be set to automatic for cluster</b><br/>Clusters with unsupported fabric version can become targets for compromise from various malware/trojan attacks that exploit known vulnerabilities in software.</td><td>Medium</td><td>Yes</td><td>No</td></tr></table>
<table>
</table>
</body></html>
